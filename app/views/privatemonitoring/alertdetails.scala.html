@*
This file is part of opq-ao.

opq-ao is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

opq-ao is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with opq-ao. If not, see <http://www.gnu.org/licenses/>.

Copyright 2013 Anthony Christe
*@

@(alert: Alert, externalEventForm: Form[ExternalEvent])

@import helper._
  @implicitFieldConstructor = @{
    FieldConstructor(twitterBootstrapInput.render)
  }

@privatepowerqualitymonitoring("Private Power Quality Monitoring - Private Alerts",
  "This page allows you to manage and create power quality events.") {
  <div class="span9">
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>Device Id</th>
          <th>Description</th>
          <th>Alert Type</th>
          <th>Timestamp</th>
          <th>Duration (ms)</th>
          <th>Alert Value</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>@alert.getDevice.getDeviceId</td>
          <td>@alert.getDevice.getDescription</td>
          <td>@alert.getAlertType.getName</td>
          <td>@utils.DateUtils.toDateTime(alert.getTimestamp)</td>
          <td>@alert.getAlertDuration</td>
          <td>
            @alert.getAlertValue
            @if(alert.getAlertType.equals(org.openpowerquality.protocol.OpqPacket.PacketType.ALERT_FREQUENCY)) {
              Hz
            }
            @if(alert.getAlertType.equals(org.openpowerquality.protocol.OpqPacket.PacketType.ALERT_VOLTAGE)) {
              Volts
            }
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="span9">
    <p><b>External Event</b></p>
    @if(flash.contains("updated")) {
      <p class="success">
      @flash.get("updated")
      </p>
    }
    @form(routes.Events.updateEventDetails(alert.getPrimaryKey), 'class -> "form-horizontal well well-small", 'name -> "externalEventForm") {
      @inputText(
        externalEventForm("eventType"), '_label -> "Event Type", 'placeholder -> "Tropical Storm Flossie", 'id -> "eventType")
      @textarea(
        externalEventForm("eventDescription"), '_label -> "Event Description", 'placeholder -> "Tropical Storm Flossie",
        'id -> "eventDescription")
      <div class="control-group">
        <div class="controls">
          <input type="submit" class="btn btn-primary" value="Update External Event" />
        </div>
      </div>
    }
  </div>
}